# GeoJSON 地图编辑器 - 产品规划与 P0 优先级

> 版本：v1.0  
> 更新日期：2026-01-26

---

## 一、项目定位

GeoJSON 地图编辑器是一个基于 **Leaflet** 的 Web 端地理信息编辑工具，提供：

- 📍 **标记与图形绘制**：点、线、面、圆、矩形
- 📋 **表格联动**：表格选中 ↔ 地图高亮
- 📸 **快照历史**：保存/加载地图状态，支持浏览模式
- 📊 **看板统计**：按类型、区域统计数量
- 📦 **导入导出**：GeoJSON、Excel、CSV

### 版本区分

| 版本 | 说明 |
|------|------|
| **Geomap-app** | 完整版，含事件追踪器、自定义组、历史地图、看板等全部功能 |
| **Geomap-app-lite** | 精简版，**不包含事件追踪器**，适用于无需事件管理的场景 |

> ⚠️ **重要**：Geomap-app-lite 不包含「事件」与「事件追踪器」相关功能，右键菜单、属性编辑器中均不显示事件相关入口。

---

## 二、P0 级别（必须优先完成）

| 功能模块 | 具体需求 | 状态 |
|----------|----------|------|
| **历史地图/浏览模式** | 多快照稳定切换，浏览模式可靠进入/退出，只读状态可解除 | ✅ 已修复 |
| **图层管理** | 隐藏/显示、编辑、删除按钮可用 | 🔧 修复中 |
| **表格联动** | 表格点击定位到地图标记（地图居中） | ✅ 已实现 |
| **事件追踪器** | 右键标记→事件追踪器可用（仅 Geomap-app） | 🔧 修复中 |
| **UI 稳定性** | 悬浮面板/Dock/draw 工具条/zoom 控件布局正确不重叠 | ✅ 已修复 |

---

## 三、P1 级别（功能增强）

| 功能模块 | 具体需求 | 状态 |
|----------|----------|------|
| **自定义底图** | 支持高德/腾讯/天地图底图切换，预留 API Key 配置 | ✅ v2.11.0 |
| **点聚合** | 大量标记自动聚合，500+ 显示 "500+" | ✅ v2.11.0 |
| **图层样式编辑** | 实时编辑颜色、透明度、线宽 | 🔧 修复中 |
| **自定义组** | 选择多个标记创建命名组 | 🔧 修复中 |
| **看板统计** | 按类型、图层维度统计，与历史地图联动 | ⏳ 待做 |

> **⚠️ 互斥逻辑说明**：
> "点聚合" 与 "标记组/自定义组" 功能互斥。启用点聚合时，将自动关闭并禁用标记组相关功能（含自动成组与手动创建组 UI）。

---

## 四、后续规划（P2+）

- **Portable 版 / 单文件版打包** ✅ v2.10.0
- **API 对接**：后端存储快照、事件、配置
- **快照对比**：前后差异高亮
- **自动保存**：增量快照
- **虚拟化列表**：大规模要素性能优化
- **WebGL 渲染**：10万+ 标记 GPU 加速

---

## 五、版本差异详细说明

### Geomap-app（完整版）

- ✅ 事件追踪器（右键菜单入口）
- ✅ 多事件管理（创建、编辑、删除事件）
- ✅ 自定义组管理
- ✅ 看板统计

### Geomap-app-lite（精简版）

- ❌ **不包含事件追踪器**
- ❌ **不包含事件字段编辑**
- ❌ 右键菜单无"事件追踪器"入口
- ✅ 其他功能与完整版一致

---

## 六、文件结构

```
Geomap-app/
├── index.html          # 主页面
├── script.js           # 核心逻辑
├── style.css           # 样式
├── marker-group.js     # 同坐标标记管理
├── selection-manager.js # 选中状态管理
├── updatedocs/         # 文档目录
│   ├── PRODUCT_PLAN_P0.md  # 本文档
│   ├── DEVELOPER_GUIDE.md
│   └── ...
└── portable/           # 便携版
```
